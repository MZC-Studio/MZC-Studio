<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="icon" href="chenweb.jpg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preload" href="/font/PHIFON.ttf" as="font" type="font/ttf" crossorigin>
    <link href="/font/stylesheet.css" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <title>陈的个人网站</title>
</head>
<body>
    <!-- 新增菜单遮罩 -->
    <div class="menu-overlay"></div>
    
    <header class="modern-header">
        <div class="header-content">
            <a href="#" class="logo">
                <img src="chenweb.jpg" alt="Logo">
                <span style="font-size: 0.9rem;">CJG Studio</span>
            </a>
        
            <button class="mobile-menu-btn">☰</button>

            <script>
                // 新增移动菜单逻辑
                const mobileBtn = document.querySelector('.mobile-menu-btn');
                const navMenu = document.querySelector('.nav-menu');
                const overlay = document.querySelector('.menu-overlay');
            
                mobileBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    navMenu.classList.toggle('mobile-open');
                    overlay.classList.toggle('active');
                });
            
                overlay.addEventListener('click', () => {
                    navMenu.classList.remove('mobile-open');
                    overlay.classList.remove('active');
                });
            
                // 初始化隐藏移动菜单按钮（根据屏幕尺寸）
                function checkWindowSize() {
                    if (window.innerWidth <= 640) {
                        mobileBtn.style.display = 'block';
                    } else {
                        mobileBtn.style.display = 'none';
                        navMenu.classList.remove('mobile-open');
                        overlay.classList.remove('active');
                    }
                }
                window.addEventListener('resize', checkWindowSize);
                checkWindowSize();
                            });
            </script>
            
            <nav class="nav-menu">
                <a href="#about" class="nav-link active">关于我</a>
                <a href="#projects" class="nav-link">项目</a>
                <a href="#contact" class="nav-link">联系</a>
                <a href="#video" class="nav-link">踩踩背</a>
                <a href="#ad" class="nav-link">更多</a>
                <a href="#guestbook" class="nav-link">留言板</a>
                <script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.0/lib/darkmode-js.min.js"></script>
                <script>
                    new Darkmode().showWidget();
                </script>
            </nav>
        </div>
    </header>
    <main>
        <section id="header">
            <div class="section-container">
                <h3>欢迎来到CJG！</h1>
                <h2">Scratch|CCW|Python|HTML</h2>
            </div>
        </section>
        <button id="backToTop" style="display:none;position:fixed;bottom:20px;right:20px;">↑</button>
            <script>
                window.addEventListener('scroll', () => {
                    const btn = document.getElementById('backToTop');
                    btn.style.display = window.scrollY > 100 ? 'block' : 'none';
                });
                
                document.getElementById('backToTop').addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
        </script>
        <section id="about">
            <div class="section-container">
                <h2 class="section-title">个人技能</h2>
                <ul>
                <li style="font-family: 'font';">Web/HTML/JS</li>
                <li style="font-family: 'font';">Python</li>
                <li style="font-family: 'font';">CCW Scratch</li>
                <li style="font-family: 'font';">界面设计</li>
                </ul>
            </div>
        </section>
        
        <section id="projects">
            <div class="section-container">
                <h2 class="section-title">项目</h2>
                <div class="projects">
                    <div class="project-card">
                        <h3 style="font-family: 'font';">小游戏</h3>
                        <p style="font-family: 'font';">一款可以打怪与联机的小游戏，目前正在测试中。推荐使用5寸及以上的手机或电脑游玩</p>
                        <a href="https://www.ccw.site/player/679197cc28de5c567e9854b6?accessKey=3fd0e1&projectId=https%3A%2F%2Fm.ccw.site%2Fuser_projects_sb3%2F264003928%2F44635306b10825e6574e5d1b70eddd0c.sb3">查看项目</a>
                    </div>
                    <div class="project-card">
                        <h3 style="font-family: 'font';">RHY-GO Project</h3>
                        <p style="font-family: 'font';">正在开发中...</p>
                        <a href="404.html">Coming S∞∞∞∞∞∞n.</a>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="contact">
            <div class="section-container">
                <h2 class="section-title">联系方式</h2>
                <p style="font-family: 'font';">邮箱：apple19782013@163.com 手机：13559928671</p>
                <p style="font-family: 'font';">GitHub: <a href="https://github.com/Klweb3928">前往我的GitHub主页</a></p>
            </div>
        </section>
            
        <section id="video">
            <div class="section-container">
                <h2 class="section-title">视频</h2>
                <iframe src="//player.bilibili.com/player.html?isOutside=true&aid=1055769058&bvid=BV1Nn4y1X7fA&cid=1602167383&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>
            </div>
        </section>
        
        <section id="ad">
            <div class="section-container">
                <h2 class="section-title">广告</h2>
                <h2 style="font-family: 'font';">广告位招租（联系我，0.01元/终身，可免费试用12个月）</h2>
                <p style="color:red,font-family: 'font';">限时优惠！！！！！！打0.000001折！</p>
            </div>
        </section>
        
        <!-- 留言板Section -->
        <section id="guestbook">
            <div class="section-container">
                <h2 class="section-title">留言板</h2>
                
                <div class="guestbook-form">
                    <form id="messageForm">
                        <div>
                            <label>昵称：</label>
                            <input type="text" id="name" required maxlength="20">
                        </div>
                        <div>
                            <label>留言内容：</label>
                            <textarea id="message" rows="4" required maxlength="200"></textarea>
                        </div>
                        <button type="submit">提交留言</button>
                    </form>
                    <div id="messageStatus"></div>
                </div>
    
                <div class="messages-container" id="messagesContainer">
                    <div class="loading">正在加载留言...</div>
                </div>
            </div>
        </section>
    
        <script>
            const firebaseConfig = {
                apiKey: "AIzaSyAo_sVPEotE7yoLderEq-1xvXob8wbaGh4",
                authDomain: "myguestbook-c216d.firebaseapp.com",
                databaseURL: "https://myguestbook-c216d-default-rtdb.asia-southeast1.firebasedatabase.app",
                projectId: "myguestbook-c216d",
                storageBucket: "myguestbook-c216d.firebasestorage.app",
                messagingSenderId: "792123654509",
                appId: "1:792123654509:web:5fd1bdaca7756071b6da64",
                measurementId: "G-J6BKJCPMBF"
            };
    
            // 初始化Firebase
            const app = firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
        
            // 获取留言引用
            const messagesRef = database.ref('messages');
        
            // 提交留言
            document.getElementById('messageForm').addEventListener('submit', (e) => {
                e.preventDefault();
                
                const name = sanitizeInput(document.getElementById('name').value);
                const message = sanitizeInput(document.getElementById('message').value);
        
                if (!name || !message) return;
        
                // 推送留言到数据库
                messagesRef.push({
                    name: name,
                    message: message,
                    timestamp: firebase.database.ServerValue.TIMESTAMP
                })
                .then(() => {
                    showMessage('留言成功！', 'success');
                    document.getElementById('messageForm').reset();
                })
                .catch((error) => {
                    showMessage(`提交失败: ${error.message}`, 'error');
                });
            });
        
            // 实时监听留言更新
            messagesRef.orderByChild('timestamp').on('value', (snapshot) => {
                const messages = [];
                snapshot.forEach((childSnapshot) => {
                    messages.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                renderMessages(messages.reverse()); // 最新留言显示在最前面
            });
        
            // 渲染留言
            function renderMessages(messages) {
                const container = document.getElementById('messagesContainer');
                container.innerHTML = messages.length > 0 
                    ? messages.map(msg => `
                        <div class="message-item" data-id="${msg.id}">
                            <div class="message-header">
                                <span>${msg.name}</span>
                                <span>${formatDate(msg.timestamp)}</span>
                            </div>
                            <div class="message-content">${msg.message}</div>
                        </div>
                    `).join('')
                    : '<div class="empty">还没有留言，快来第一个留言吧！</div>';
            }
        
            // 辅助函数
            function sanitizeInput(text) {
                return text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
            }
        
            function formatDate(timestamp) {
                const date = new Date(timestamp);
                return date.toLocaleString('zh-CN');
            }
        
            function showMessage(text, type = 'success') {
                const statusDiv = document.getElementById('messageStatus');
                statusDiv.innerHTML = `<div class="alert ${type}">${text}</div>`;
                setTimeout(() => statusDiv.innerHTML = '', 3000);
            }
        </script>

        
        <style>
        .guestbook-form {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .guestbook-form form div {
            margin-bottom: 15px;
        }
        
        .guestbook-form label {
            display: block;
            margin-bottom: 5px;
        }
        
        .guestbook-form input,
        .guestbook-form textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        button {
            background: #2c3e50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background: #34495e;
        }
        
        .messages-container {
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        
        .message-item {
            background: #fff;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #666;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #999;
        }

            /* 新增样式 */
        .alert {
            padding: 12px;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .alert.success {
            background: #d4edda;
            color: #155724;
        }

        .alert.error {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
        </style>
    
        <footer>
            © 2025 <a href="https://github.com/Klweb3928">Klweb3928</a> 保留所有权利
            此网页由<a href="https://pages.github.com/">GitHub Pages(Github.io)</a>驱动
            <br>网站工具:</br><a href="/font/fontdemo.html">字体测试</a>
            <br><a href="/CAPTCHA.html">我的BiliBili帐号[需验证密码]</a></br>
        </footer>
    
        <script>
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        </script>
    </main>
</body>
</html>
